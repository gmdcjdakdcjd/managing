<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/basic.html}">
<head>
  <meta charset="UTF-8">
  <title>ë°°ì¹˜ ì‹¤í–‰ í˜„í™© (ê´€ë¦¬ììš©)</title>

  <!-- âœ… GitHub Markdown ìŠ¤íƒ€ì¼ -->
  <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/github-markdown-css/5.2.0/github-markdown-light.min.css"/>

  <style>
    .admin-container {
      max-width: 900px; /* ğŸ”½ ê¸°ì¡´ 1250 â†’ 900 */
      margin: 1.5rem auto;
      background: #fff;
      padding: 1.5rem 2rem;
      border-radius: 10px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.05);
    }

    .admin-title {
      font-size: 1.2rem;
      font-weight: 700;
      margin-bottom: 0.8rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    table.admin-table {
      width: 100%;
      border-collapse: collapse;
      font-size: 0.9rem;
    }

    table.admin-table th,
    table.admin-table td {
      padding: 0.35rem 0.6rem;
      border-bottom: 1px solid #e2e2e2;
      text-align: left;
      vertical-align: middle;
    }

    table.admin-table th {
      font-weight: 600;
      background-color: #f7f8fa;
    }

    table.admin-table tr:hover {
      background-color: rgba(0,0,0,0.02);
    }

    .toggle-btn {
      cursor: pointer;
      color: #0d6efd;
      font-weight: 600;
    }

    .detail-row { display: none; }

    .detail-box {
      background-color: #f9fafb;
      border-radius: 4px;
      padding: 0.6rem 0.8rem;
      font-size: 0.85rem;
      border-top: 1px solid #ddd;
      margin-top: -1px;
    }

    /* âœ… markdown ë³¸ë¬¸ ì˜ì—­ */
    .markdown-body {
      background: #fff;
      padding: 1rem;
      border-radius: 6px;
      border: 1px solid #e2e2e2;
      overflow-x: auto;
    }

    .markdown-body {
      font-size: 0.85rem;
    }

    .markdown-body table {
      font-size: 0.8rem;
      width: 95%;
      margin: 0 auto;
    }

    .detail-box .markdown-body {
      max-width: 800px;
    }ã…£
  </style>

  <script>
    function toggleDetail(rowId) {
      document.querySelectorAll('.detail-row').forEach(row => {
        if (row.id !== rowId) row.style.display = 'none';
      });

      const target = document.getElementById(rowId);
      if (!target) return;

      const isHidden = target.style.display === 'none' || target.style.display === '';
      target.style.display = isHidden ? 'table-row' : 'none';
    }
  </script>
</head>

<body>
<div layout:fragment="content" class="admin-container">
  <h3 class="admin-title">ğŸ§© ë°°ì¹˜ ì‹¤í–‰ í˜„í™© (ê´€ë¦¬ììš©)</h3>

  <table class="admin-table">
    <thead>
    <tr>
      <th>ğŸ“… ë‚ ì§œ</th>
      <th>ê´€ë¦¬ ì¢…ëª©</th>
      <th>ì‹¤í–‰ì£¼ì²´</th>
      <th>ë°°ì¹˜ ê·¸ë£¹</th>
      <th class="icon-col">ìƒì„¸ê²°ê³¼</th>
    </tr>
    </thead>

    <tbody>
    <th:block th:each="report : ${reports}">
      <tr>
        <td th:text="${#strings.substring(report.title, 7, 18)}"></td>
        <td>ì½”ìŠ¤í”¼ / ETF / S&P</td>
        <td th:text="${report.writer}"></td>
        <td class="toggle-btn"
            th:onclick="|toggleDetail('detail-batch-${report.bno}')|">+ ë°°ì¹˜</td>
        <td class="icon-col">
          <a class="btn-icon"
             th:if="${report.fileNames != null and #lists.size(report.fileNames) > 0}"
             th:href="@{/view/{fileName}(fileName=${report.fileNames[0]})}"
             target="_blank">ğŸ‘</a>
        </td>
      </tr>

      <!-- âœ… ìƒì„¸í–‰ì„ ê°™ì€ each ë¸”ë¡ ì•ˆìœ¼ë¡œ í¬í•¨ -->
      <tr th:id="|detail-batch-${report.bno}|" class="detail-row">
        <td colspan="9">
          <div class="detail-box">
            <p><strong>ğŸ“‚ ìƒì„¸ ë°°ì¹˜ ëª©ë¡</strong></p>

            <div class="markdown-body" th:utext="${report.content}"></div>
          </div>
        </td>
      </tr>
    </th:block>
    </tbody>

  </table>
</div>
</body>
</html>
